<h1>Chapman Spring 2015</h1> </center>
<%= link_to "Delete duplicates", sections_dedupe_path %>
  <hr>
  <div class="row">
    <div class="col-md-9">
      
  <%= javascript_tag "var autocomplete_items = #{ @autocomplete_items.pluck(:section_name_and_title).to_json };" %>
      <%= javascript_tag "var autocomplete_majors = #{ @autocomplete_majors.pluck(:name).to_json };" %>
      <%= javascript_tag "var autocomplete_teachers = #{ @autocomplete_items.pluck(:teacher).to_json };" %>
<script type="text/javascript">
  $('#the-basics2 .typeahead').typeahead({ 
    hint: true, highlight: true, minLength: 1 },
{ name: 'states', displayKey: 'value', source: substringMatcher(autocomplete_items), templates: {
  header: '<h3 style="padding-left: 10px;" class="league-name">Sections</h3>'
                                            }
},
                                         {
                                            name: 'nba-teams',
                                            displayKey: 'value',
                                            source: substringMatcher(autocomplete_majors),
                                            templates: {
                                              header: '<h3 style="padding-left: 10px;" class="league-name">Majors</h3>'
                                            }
                                          },
                                         {
                                            name: 'nba-teams',
                                            displayKey: 'value',
                                            source: substringMatcher(autocomplete_teachers),
                                            templates: {
                                              header: '<h3 style="padding-left: 10px;" class="league-name">Teacher</h3>'
                                            }
                                          }
                                        ).css('width','400px');
</script>
<script>
  $('#hours').slider({ 
        formater: function(value) {
            return formatTime(minutesToTime(value));
        },
        
        tooltip_separator: " to ", 
    }).on("slideStop", drawTables);
  
  function drawTables() {
      
    }
  
</script>
<table  class="table table-striped table-hover">
  <thead>
    <tr>
      <th>Course</th>
      <th>Term</th>
      <th>Teacher</th>
      <th>Schedule</th>
      <th>Major</th>
      <th>GE</th>
      <th>Capacity</th>
      <th>Wishlist</th>
      <th>Settings</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @sections.each do |section| %>
      <tr>
        <td><%= section.section_name_and_title %></td>
        <td><%= section.term %></td>
        <td><%= section.teacher %></td>
        <td><%= section.schedule %></td>
        <td><%= section.academic_level %></td>
        <td><%= section.ge %></td>
        <td><%= section.capacity %></td>
        
        <td><% if user_signed_in? && current_user.enrolled?(section) %>
          <%= link_to Enrollment.where(:user_id => current_user.id, :section_id => section.id).first, class: "btn btn-sm btn-warning", method: :delete do |f| %>
       <%= section.enrollments.count %> <i class="fa fa-star"></i> On Wishlist
          <% end %>    
          <% else %>
          <% if user_signed_in? &&  %>
          <%= form_for [current_user, Enrollment.new], html: { id: 'form_id' }, url: { controller: :enrollments, user_id: current_user.id } do |f| %>
            <%= f.hidden_field :user_id, value: current_user.id %>
            <%= f.hidden_field :section_id, value: section.id %>
             <%= button_tag(type: "submit", class: "btn btn-default btn-sm") do %>
            <%= section.enrollments.count %> <i class="fa fa-star-o"></i> Wishlist?
        <% end %>
      <% end %>
          <% else %>
          <h5 class="text-danger"><%= section.enrollments.count %> <i class="fa fa-heart"></i></h4>
          <% end %>
          <% end %> </td>
       <td><div class="dropdown pull-right">
      <button class="btn btn-default dropdown-toggle pull-right" type="button" id="dropdownMenu1" data-toggle="dropdown">
        
        <i class="fa fa-gear"></i>
      </button>
      <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
        <li role="presentation"><%= link_to 'Edit', edit_section_path(section) %></li>
        <li role="presentation"><%= link_to 'Destroy', section, method: :delete, data: { confirm: 'Are you sure?' } %></li>
      </ul>
          </div></td>
      </tr>
    <% end %>
  </tbody>
</table>
 <%= will_paginate @collection, renderer: BootstrapPagination::Rails %>
<br>
    </div>
    
    <div class="col-md-3">
      <div class="panel panel-default">
        <div class="panel-body">
          Spring 2015 Wishlist<br>
          <% if user_signed_in? %>
            <% current_user.enrollments.each do |f| %>
              <p>
                <% if Section.exists?(f.section_id) and f.section.course.presence %>
                <%= link_to f.section.course.full_name, f.section %>
              <% end %>
              </p>
          
          <% end %>
          <% else %> <%= link_to "Log in to save your schedule", new_user_session_path %>
          <% end %>
        </div>
      </div>
      See incorrect or questionable information? Use the Flag button to mark it as bad information. If more than one person flags it, it will become automatically disabled and removed from search. The Ambassadors will then be notified and resolve the issue. 
    </div>
